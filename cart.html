<!DOCTYPE html>
<html>
<head>
    <title>Cart</title>
    <link rel="stylesheet" href="cart.css">
</head>
<body>

<h2>Your Cart</h2>
<div id="cart-items"></div>
<h3>Delivery: 20 EGP</h3>
<h3>Total: <span id="total">0</span> EGP</h3>

<input type="text" id="address" placeholder="Enter your address">
<button id="checkout">Place Order</button>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function renderCart() {
        const cartDiv = document.getElementById('cart-items');
        cartDiv.innerHTML = "";
        let total = 0;

        cart.forEach((item, index) => {
            if(item.name && item.price && item.qty > 0) {
                const div = document.createElement('div');
                div.innerHTML = `
                    ${item.name} - ${item.price} EGP x ${item.qty} 
                    <button class="remove-item" data-index="${index}">Remove 1</button>
                `;
                cartDiv.appendChild(div);
                total += item.price * item.qty;
            }
        });

        document.getElementById('total').textContent = total;
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    renderCart();

    // إزالة كمية واحدة من المنتج
    $(document).on('click', '.remove-item', function() {
        const index = $(this).data('index');
        if(cart[index].qty > 1) {
            cart[index].qty -= 1;
        } else {
            cart.splice(index, 1); // لو الكمية 1، يشيل المنتج
        }
        renderCart();
    });

    // زر Place Order
    document.getElementById('checkout').addEventListener('click', () => {
        const address = document.getElementById('address').value.trim();
        if(address === "") {
            alert("Please enter your address!");
            return;
        }
        const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
        alert("Order placed! Total: " + total + " EGP\nAddress: " + address);
        localStorage.removeItem('cart');
        location.reload();
    });
</script>

</body>
</html>
