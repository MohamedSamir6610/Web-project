<!DOCTYPE html>
<html>
<head>
    <title>Cart</title>
    <link rel="stylesheet" href="cart.css">
</head>
<body>

<h2>Your Cart</h2>
<div id="cart-items"></div>


<div id="summary">
    <p>Delivery: <span id="delivery">20</span> EGP</p>
    <p>Total: <span id="total">0</span> EGP</p>
</div>


<input type="text" id="address" placeholder="Enter your address">
<textarea id="note" placeholder="Add a note (optional)" rows="3"></textarea>
<button id="checkout">Place Order</button>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
    const deliveryFee = 20;
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function renderCart() {
        const cartDiv = document.getElementById('cart-items');
        cartDiv.innerHTML = "";
        let total = 0;

        cart.forEach((item, index) => {
            if(item.name && item.price && item.qty > 0) {
                const div = document.createElement('div');
                div.className = "cart-block";
                div.innerHTML = `
                    <img src="${item.img}" alt="${item.name}">
                    <div class="cart-info">
                        <h4>${item.name}</h4>
                        <p>Price: ${item.price} EGP</p>
                        <p>Quantity: ${item.qty}</p>
                        <button class="remove-item" data-index="${index}">Remove 1</button>
                    </div>
                `;
                cartDiv.appendChild(div);
                total += item.price * item.qty;
            }
        });

        document.getElementById('total').textContent = total + deliveryFee;
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    renderCart();

    $(document).on('click', '.remove-item', function() {
        const index = $(this).data('index');
        if(cart[index].qty > 1) {
            cart[index].qty -= 1;
        } else {
            cart.splice(index, 1);
        }
        renderCart();
    });

    
    document.getElementById('checkout').addEventListener('click', () => {
        const address = document.getElementById('address').value.trim();
        const note = document.getElementById('note').value.trim();
        if(address === "") {
            alert("Please enter your address!");
            return;
        }
        const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0) + deliveryFee;
        alert("Order placed! Total: " + total + " EGP\nAddress: " + address + (note ? "\nNote: " + note : ""));
        localStorage.removeItem('cart');
        window.location.href = "home.html"; 
    });
</script>

</body>
</html>
